<div class="container">
  <form
    [formGroup]="postForm"
    (ngSubmit)="onSubmit()"
    class="form"
    *ngIf="createPost"
  >
    <div class="head">
      
      <button
        type="button"
        class="btn1"
        value="postBtn"
        (click)="change('Post')"
        id="postBtn"
      >
        Post
      </button>
      <button
        type="button"
        class="btn2"
        value="eventBtn"
        (click)="change('Event')"
        id="eventBtn"
      >
        Event
      </button>
    </div>

    <div class="Subhead">
      <div class="SelectCommunity">
        <div class="title">Community:</div>
        <div class="select">
          <ion-select
            formControlName="community"
            placeholder="Add a community"
            [(ngModel)]="inputValue2"
            (ionChange)="checkInput()"
          >
            <ion-select-option
              *ngFor="let community of profile?.communities"
              [value]="community"
              class="option"
            >
              {{ community }}</ion-select-option
            >
          </ion-select>
        </div>
      </div>
      <div class="SelectCategory">
        <div class="title">Categories:</div>
        <div class="select">
          <ion-select
            multiple
            formControlName="category"
            placeholder="Add categories"
            (ionChange)="limitSelection()"
          >
            <ion-select-option
              *ngFor="let category of categories"
              [value]="category"
            >
              {{ category }}</ion-select-option
            >
          </ion-select>
        </div>
      </div>
    </div>

    <div class="TextHead">
      <ion-textarea
        [(ngModel)]="inputValue"
        (input)="checkInput()"
        formControlName="title"
        placeholder="Add a title"
        class="custom"
        [counter]="true"
        [maxlength]="100"
      ></ion-textarea>
    </div>

    <!--create a post div-->

    <div class="TextBody">
      <ion-textarea
        formControlName="text"
        placeholder="Text (Optional)"
        class="custom2"
      ></ion-textarea>
    </div>
    <div class="TextFooter">
      <!-- <ion-avatar> -->
        <ion-item>
        <div class="overlay-image">
          <input
            id="image-input"
            type="file"
            [accept]="requiredFileType"
            (change)="onFileSelected($event)"
            class="file-input"
          />
          <label for="image-input" class="file-label">
            <ion-icon
              name="image-outline"
              class="icon imageIcon"
              style="font-size: 25px"
            ></ion-icon>
          </label>
        </div>
        </ion-item>
      <!-- </ion-avatar> -->
      <button
        *ngIf="spoilers"
        type="button"
        class="btns tagbtnclicked"
        (click)="Spoilers()"
      >
        <ion-icon name="add-outline"></ion-icon>
        <span>Spoilers</span>
      </button>

      <button
        id="spoilerBtn"
        *ngIf="!spoilers"
        type="button"
        class="btns tagbtn"
        (click)="Spoilers()"
      >
        <ion-icon name="add-outline"></ion-icon>
        <span>Spoilers</span>
      </button>

      <button
        *ngIf="agerestricted"
        type="button"
        class="btns tagbtnclicked"
        (click)="AgeRestricted()"
      >
        <ion-icon name="add-outline"> </ion-icon>NSFW
      </button>

      <button
        *ngIf="!agerestricted"
        type="button"
        class="btns tagbtn"
        (click)="AgeRestricted()"
      >
        <ion-icon name="add-outline"> </ion-icon>NSFW
      </button>

      <button
        *ngIf="isValid"
        type="submit"
        class="btns validPost"
        style="color: white"
        (click)="closePopup()"
      >
        Post
      </button>

      <button
        *ngIf="!isValid"
        type="submit"
        disabled="true"
        class="btns"
        style="background-color: darkgray; color: grey"
        (click)="closePopup()"
      >
        Post
      </button>
    </div>
  </form>
  <!--create a event div-->
  <form
    [formGroup]="eventForm"
    (ngSubmit)="onSubmitEvent()"
    class="form"
    *ngIf="createEvent"
  >
    <div class="head">
      <button
        type="button"
        class="btn2"
        value="postBtn"
        (click)="change('Post')"
      >
        Post
      </button>
      <button
        type="button"
        class="btn3"
        value="eventBtn"
        (click)="change('Event')"
      >
        Event
      </button>
    </div>

    <div class="Subhead">
      <div class="SelectCommunity">
        <div class="title">Community:</div>
        <div class="select">
          <ion-select
            formControlName="community"
            placeholder="Add a community"
            [(ngModel)]="inputValue2"
            (ionChange)="checkEventInput()"
          >
            <ion-select-option
              *ngFor="let community of adminCommunities"
              [value]="community"
              class="option"
            >
              {{ community }}</ion-select-option
            >
          </ion-select>
        </div>
      </div>
      <div class="SelectCategory">
        <div class="title">Categories:</div>
        <div class="select">
          <ion-select
            multiple
            formControlName="category"
            placeholder="Add categories"
            (ionChange)="limitSelection2()"
          >
            <ion-select-option
              *ngFor="let category of categories"
              [value]="category"
            >
              {{ category }}</ion-select-option
            >
          </ion-select>
        </div>
      </div>
    </div>

    <div class="TextHead">
      <ion-textarea
        formControlName="title"
        placeholder="Add a title"
        class="custom"
        [counter]="true"
        [maxlength]="100"
        (ionChange)="checkEventInput()"
      ></ion-textarea>
    </div>

    <!--create a event div-->
    <div class="eventClass">
      <div class="TextBody2">
        <ion-textarea
          formControlName="text"
          placeholder="Describe the Challenge"
          (ionChange)="checkEventInput()"
          class="custom3"
        ></ion-textarea>
      </div>
      <div class="TaskBody">
        <div class="input-box">
          <ion-input
            class="input"
            formControlName="challenges"
            placeholder="Add a challenge task..."
            (keyup.enter)="addTask()"
          ></ion-input>

          <ion-button
            fill="clear"
            *ngIf="Added"
            type="submit"
            (click)="addTask()"
          >
            <ion-icon name="send" class="icon1"></ion-icon>
          </ion-button>
          <ion-button
            id="sendBtn"
            fill="clear"
            *ngIf="!Added"
            disabled="true"
            type="submit"
            (click)="addTask()"
          >
            <ion-icon name="send" class="icon2"></ion-icon>
          </ion-button>
        </div>
        <!-- <ion-list>
        <ion-item class="taskItem" *ngFor="let challengeControl of challenges.controls; let i = index">
          <ion-textarea
            [formControl]="getFormControl(i)"
            placeholder="Add a challenge task"
            (ionChange)="checkEventInput()"
            class="custom4"
          ></ion-textarea>
          <ion-button fill="clear" size="larger" slot="end" (click)="removeChallenge(i)" *ngIf="i !== 0">
            <ion-icon
              slot="icon-only"
              class="removeTask"
              name="remove-circle"
            ></ion-icon>
          </ion-button>
        </ion-item>
        </ion-list> -->
      </div>
      <div style="display: flex; align-items: center; flex-direction: column">
        <div *ngFor="let prompt of prompts; let k = index" class="Prompt">
          Step {{ k + 1 }}: {{ prompt }}
        </div>
      </div>

      <div class="TaskBody2">
        <ion-button class="addMoreTask" size="larger" (click)="RemoveTask()">
          <ion-icon
            slot="icon-only"
            class="addTask"
            name="remove-circle"
            size="larger"
          ></ion-icon>
        </ion-button>
      </div>

      <div class="TaskDatesLabels">
        <ion-row>
          <ion-col> <ion-text>Start Date</ion-text> </ion-col>
          <ion-col> <ion-text>End Date</ion-text> </ion-col>
        </ion-row>
      </div>

      <!--DATE PICKER CODE-->
      <div>
        <ion-row>
          <ion-col class="picker">
            {{ formattedDate }}
          </ion-col>

          <!-- End Date -->
          <ion-col class="picker">
            <ion-datetime-button
              datetime="datetime"
              id="endDate"
              size="larger"
              class="date"
            ></ion-datetime-button>
          </ion-col>
        </ion-row>

        <!-- Date Picker Date -->
        <ion-popover [keepContentsMounted]="true">
          <ng-template #popovercontent>
            <ion-datetime
              class="custom-datetime"
              id="datetime"
              displayFormat="DD/MM/YYYY"
              presentation="date"
              formControlName="endDate"
              color="calandar"
              (ionChange)="closePopover()"
            >
            </ion-datetime>
          </ng-template>
        </ion-popover>
      </div>

      <div class="Quiz">
        <h3>Quiz</h3>
        <p>Give a description for your quiz topic:</p>
        <ion-textarea
          class="custom3"
          formControlName="quizDescription"
          (ionChange)="checkEventInput()"
        ></ion-textarea>
        <ion-radio-group formControlName="selectedOption" class="level">
          <div class="radio">
            <ion-radio
              value="5"
              labelPlacement="end"
              (click)="checkEventInput()"
              >Short <br />
              5 Questions</ion-radio
            >
          </div>
          <div class="radio">
            <ion-radio
              value="10"
              labelPlacement="end"
              (click)="checkEventInput()"
              >Medium <br />
              10 Questions</ion-radio
            >
          </div>
          <div class="radio">
            <ion-radio
              value="15"
              labelPlacement="end"
              (click)="checkEventInput()"
              >Long <br />
              15 Questions</ion-radio
            >
          </div>
        </ion-radio-group>
      </div>

      <div class="TextFooterEvent">
        <button
          *ngIf="isEventValid"
          type="submit"
          class="btns validPostEvent"
          style="color: white"
          (click)="closePopup()"
        >
          Create
        </button>

        <button
          *ngIf="!isEventValid"
          type="submit"
          disabled="true"
          class="btns"
          style="background-color: darkgray; color: grey"
          (click)="closePopup()"
        >
          Create
        </button>
      </div>
    </div>
  </form>
</div>
